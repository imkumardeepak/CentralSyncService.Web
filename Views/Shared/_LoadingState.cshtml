@*
    Loading State Component (Skeleton Loader)
    Usage: @await Html.PartialAsync("_LoadingState", new { 
        Type = "table", // table, card, stat, form
        Rows = 5,
        Columns = 4
    })
*@
@{
    // Safely extract properties from the model
    var modelType = ViewData.Model?.GetType();
    var type = "table";
    var rows = 5;
    var columns = 4;
    
    if (ViewData.Model != null)
    {
        try
        {
            var t = modelType?.GetProperty("Type")?.GetValue(ViewData.Model);
            if (t != null) type = t.ToString();
            
            var r = modelType?.GetProperty("Rows")?.GetValue(ViewData.Model);
            if (r != null) rows = Convert.ToInt32(r);
            
            var c = modelType?.GetProperty("Columns")?.GetValue(ViewData.Model);
            if (c != null) columns = Convert.ToInt32(c);
        }
        catch { }
    }
}

@switch (type)
{
    case "table":
        <div class="animate-pulse">
            <!-- Table Header Skeleton -->
            <div class="bg-neutral-100 px-4 py-3 flex gap-4">
                @for (int c = 0; c < columns; c++)
                {
                    <div class="h-4 bg-neutral-300 rounded flex-1"></div>
                }
            </div>
            <!-- Table Rows Skeleton -->
            @for (int r = 0; r < rows; r++)
            {
                <div class="px-4 py-4 flex gap-4 border-b border-neutral-100">
                    @for (int c = 0; c < columns; c++)
                    {
                        <div class="h-4 bg-neutral-200 rounded flex-1"></div>
                    }
                </div>
            }
        </div>
        break;
        
    case "card":
        @for (int i = 0; i < rows; i++)
        {
            <div class="bg-white rounded-lg shadow-sm border border-neutral-200 p-6 animate-pulse mb-4">
                <div class="h-4 bg-neutral-200 rounded w-1/4 mb-4"></div>
                <div class="h-6 bg-neutral-200 rounded w-1/2 mb-2"></div>
                <div class="h-4 bg-neutral-100 rounded w-3/4"></div>
            </div>
        }
        break;
        
    case "stat":
        <div class="grid gap-4 md:grid-cols-4">
            @for (int i = 0; i < 4; i++)
            {
                <div class="bg-white rounded-lg shadow-sm border border-neutral-200 p-4 animate-pulse">
                    <div class="h-3 bg-neutral-200 rounded w-1/2 mb-3"></div>
                    <div class="h-7 bg-neutral-200 rounded w-1/3"></div>
                </div>
            }
        </div>
        break;
        
    case "form":
        <div class="space-y-6 animate-pulse">
            @for (int i = 0; i < rows; i++)
            {
                <div>
                    <div class="h-4 bg-neutral-200 rounded w-1/6 mb-2"></div>
                    <div class="h-10 bg-neutral-100 rounded w-full"></div>
                </div>
            }
        </div>
        break;
        
    default:
        <!-- Generic content skeleton -->
        <div class="animate-pulse space-y-4">
            @for (int i = 0; i < rows; i++)
            {
                <div class="h-4 bg-neutral-200 rounded w-3/4"></div>
            }
        </div>
        break;
}
